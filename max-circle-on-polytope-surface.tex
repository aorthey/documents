\documentclass{article}

\usepackage{filecontents}
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage[bookmarks=true]{hyperref}

\def\R{\ensuremath{\mathbb{R}}}
\begin{filecontents}{tmp.bib}
@book{boyd,
  title={\href{http://stanford.edu/~boyd/cvxbook/}{Convex Optimization}},
  author={Boyd, Stephen and Vandenberghe, Lieven},
  year={2004},
  publisher={Cambridge university press}
}

\end{filecontents}

\begin{document} 

\title{The maximum ball on a surface element of a polytope as a convex
optimization problem} 
\author{Andreas Orthey}
\date{}
\maketitle

%%%%%%%%%%%%%%%%%
\input{figure-circle-on-polytope-surface.tex}

Let us start with considering the problem of finding the
maximum ball $\mathcal{B}_R=\{x \in \R^N | \|x\| \leq R\}$, inside a polytope
$\mathcal{P} = \{x \in \R^N| a_i^T x \leq b_i, i=1,\cdots,M\}$.  As explained in
\cite{boyd}, this problem can be formulated as a linear programming problem.
The main insight is: Each hyperplane of the polytope can be seen as a
tangentialplane for a specific ball radius. The shortest distance between the
tangentialplane and the center of the ball is given by the radius multiplied by
the normal of the plane. Ergo to see if the ball is inside of the halfspace
defined by the hyperplane, we need to check the shortest distance only. Let us
denote this intersection of ball with hyperplane normal as $v_i = y +
R\frac{a_i}{\|a_i\|}$, with $y$ being the center of the ball. Now, intuitively the ball is
inside of the polytope iff each $v_i$ is inside of the polytope, meaning we need
to have the inequalities $a_i^Tv_i \leq b_i$ fulfilled. This gives us the linear programming formulation which can be found in \cite{boyd}:

\begin{equation}
        \begin{aligned}
                &\underset{y \in \R^N, R \in \R}{\text{maximize }}&&R\\
                &\text{subject to }&& a_i^T y + R\|a_i\|_2 \leq b_i\\
                &&& R \geq 0
        \end{aligned}
\end{equation}

Let us now consider the problem of finding the maximum ball in dimension $N-1$, $\mathcal{B}_R=\{x
\in \R^{N-1} | \|x\| \leq R\}$, restricted to a surface element of $\mathcal{P}$, which we denote as
\begin{center}
$\mathcal{S} = \{x \in \R^N| a_p^Tx=b_p, a_i^T x \leq b_i, i=1,\cdots,p-1,p+1,\cdots,M\}$
\end{center}

Meaning, the surface element $a_p^Tx=b_p$ will be intersected by the other
hyperplanes, which essentially makes this problem a lowerdimensional one. Since
we are operating on our surface element, we are interested in finding the normal
vectors, lying on the surface and pointing towards the intersection of the other
hyperplanes. Meaning, instead of having $v_i = y + R\frac{a_i}{\|a_i\|}$, we
need to find the orthogonal projection of $a_i$ onto the surface element, which
we get by $v_i = y + R\frac{a_i'}{\|a_i'\|}$ with $a_i' = a_i -
(a_i^Ta_p)a_p$ being the orthogonal projected vector. The resulting
linear optimization problem is

\begin{equation}
        \begin{aligned}
                &\underset{y \in \R^n, r \in \R}{\text{maximize }}&&R\\
                &\text{subject to }&& a_i^T y + R
                 \frac{a_i^T a_i'}{\|a_i'\|}\leq b_i,\\
                 &&&i\in \{1,\cdots,p-1,p+1,\cdots,m\}\\
                &&& a_i' = a_i - (a_i^Ta_p)a_p\\
                &&& a_p^Ty = b_p\\
                &&& R \geq 0
        \end{aligned}
\end{equation}
        whereby $R$ is the radius of the circle, $y$ the center, $a_i'$ is the
                orthogonal projection onto the hyperplane of $a_p$.




\bibliographystyle{plainnat}
\bibliography{tmp} 
\end{document}

